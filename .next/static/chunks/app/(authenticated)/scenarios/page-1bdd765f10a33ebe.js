(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2688],{24144:function(e,t,r){Promise.resolve().then(r.bind(r,86697))},86697:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return E}});var n=r(57437),a=r(2265),s=r(99376),o=r(80496),i=r(40525),c=r(86760),l=r(21218),d=r(97869),u=r(97354),p=r(32113),m=r(33628),y=r(88437),g=r(93837);function E(){let e=(0,s.useRouter)(),{household:t}=(0,i.Un)(),{scenarioList:r,loadScenarios:E,createScenario:h,deleteScenario:f,duplicateScenario:S,updateScenario:x,error:C}=(0,i.rz)();console.log("ScenariosPage (src/app/(authenticated)/scenarios/page.tsx): Store state:",c.o.getState()),console.log("ScenariosPage (src/app/(authenticated)/scenarios/page.tsx): scenarioList:",r);let[R,N]=(0,a.useState)(!0),[v,A]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{try{N(!0),console.log("ScenariosPage (src/app/(authenticated)/scenarios/page.tsx): Loading scenarios..."),E(),console.log("ScenariosPage (src/app/(authenticated)/scenarios/page.tsx): Scenarios loaded successfully")}catch(e){console.error("ScenariosPage (src/app/(authenticated)/scenarios/page.tsx): Error loading scenarios:",e),A(e instanceof Error?e.message:"Failed to load scenarios"),(0,l.Am)({title:"Error",description:"Failed to load scenarios",type:"error"})}finally{N(!1)}})()},[E]);let w=async r=>{N(!0);try{var n,a;console.log("ScenariosPage (src/app/(authenticated)/scenarios/page.tsx): Creating scenario with data from modal:",r);let s=(null==t?void 0:t.originCountry)||d.Cv.GB;console.log("ScenariosPage (src/app/(authenticated)/scenarios/page.tsx): Using origin country from profile (or default GB):",s);let o={name:r.name,description:r.description,content:{schemaVersion:u.O,originCountry:s,destinationCountry:r.destinationCountry,completionStatus:"draft",household:{id:(0,g.Z)(),createdAt:new Date,updatedAt:new Date,name:"Household for ".concat(r.name),members:(null==t?void 0:t.members)||[],originCountry:s,destinationCountry:r.destinationCountry,residencyStatus:(null==t?void 0:t.residencyStatus)||d.DL.TEMPORARY_RESIDENT,taxRegime:(null==t?void 0:t.taxRegime)||d.LT.STANDARD,size:(null==t?void 0:null===(n=t.members)||void 0===n?void 0:n.length)||0,dependents:(null==t?void 0:null===(a=t.members)||void 0===a?void 0:a.filter(e=>e.isDependent).length)||0},incomeSources:[],housingType:p.Rj.RENT,housingExpense:{id:(0,g.Z)(),createdAt:new Date,updatedAt:new Date,type:p.Rj.RENT,address:{line1:"",city:"",postalCode:"",country:r.destinationCountry},mainCost:{amount:0,currency:d.NE.EUR,frequency:d.oF.MONTHLY},cost:{amount:0,currency:d.NE.EUR,frequency:d.oF.MONTHLY},size:0,bedrooms:0,bathrooms:0,furnished:!1,utilities:[],insurance:[]},educationExpenses:{},healthcareType:m._.PUBLIC,healthcareExpenses:{},transportType:y.F.PUBLIC,transportExpense:{id:(0,g.Z)(),createdAt:new Date,updatedAt:new Date,type:y.F.PUBLIC,mainCost:{amount:0,currency:d.NE.EUR,frequency:d.oF.MONTHLY},costs:[],isCommute:!1},lifestyleExpenses:[],utilityExpenses:{},emergencyFund:{id:(0,g.Z)(),createdAt:new Date,updatedAt:new Date,targetMonths:3,currentBalance:{amount:0,currency:d.NE.EUR},monthlyContribution:{amount:0,currency:d.NE.EUR},minimumBalance:{amount:0,currency:d.NE.EUR},location:"",isLiquid:!0},fxSettings:{baseCurrency:d.NE.EUR,displayCurrency:d.NE.EUR,displayCurrencies:[d.NE.EUR,d.NE.GBP],manualRates:!1,customRates:{},sensitivityRange:[-10,10]}}};console.log("ScenariosPage (src/app/(authenticated)/scenarios/page.tsx): Full ScenarioInput object prepared:",o);let i=await h(o);if(i)(0,l.Am)({title:"Scenario Created",description:"Successfully created scenario: ".concat(o.name),type:"success"}),e.push("/scenario/".concat(i,"/edit"));else throw Error("Scenario creation failed or did not return a valid ID.")}catch(t){console.error("ScenariosPage (src/app/(authenticated)/scenarios/page.tsx): Error creating scenario:",t);let e=t instanceof Error?t.message:"Failed to create scenario";A(e),(0,l.Am)({title:"Error",description:e,type:"error"})}finally{N(!1)}},D=async e=>{try{await f(e),(0,l.Am)({title:"Success",description:"Scenario deleted successfully",type:"success"})}catch(e){console.error("Error deleting scenario:",e),A(e instanceof Error?e.message:"Failed to delete scenario"),(0,l.Am)({title:"Error",description:"Failed to delete scenario",type:"error"})}},F=async t=>{try{let r=await S(t);if(r)(0,l.Am)({title:"Success",description:"Scenario duplicated successfully",type:"success"}),e.push("/scenario/".concat(r,"/edit"));else throw Error("Scenario duplication failed or did not return a valid ID.")}catch(e){console.error("Error duplicating scenario:",e),A(e instanceof Error?e.message:"Failed to duplicate scenario"),(0,l.Am)({title:"Error",description:"Failed to duplicate scenario",type:"error"})}},b=async(e,t)=>{try{await x(e,{name:t}),(0,l.Am)({title:"Success",description:"Scenario renamed successfully",type:"success"}),E()}catch(e){console.error("Error renaming scenario:",e),A(e instanceof Error?e.message:"Failed to rename scenario"),(0,l.Am)({title:"Error",description:"Failed to rename scenario",type:"error"})}};return R?(0,n.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,n.jsx)("p",{children:"Loading scenarios..."})}):v||C?(0,n.jsxs)("div",{className:"flex justify-center items-center h-screen text-red-500",children:[(0,n.jsxs)("p",{children:["Error: ",v||C]}),(0,n.jsx)("button",{onClick:()=>E(),className:"ml-4 p-2 bg-blue-500 text-white rounded",children:"Retry"})]}):(0,n.jsx)("div",{className:"container mx-auto p-4",children:(0,n.jsx)(o.D,{scenarios:r,onCreateScenario:w,onDeleteScenario:D,onDuplicateScenario:F,onRenameScenario:b})})}}},function(e){e.O(0,[6373,9692,6760,1218,496,2971,2117,1744],function(){return e(e.s=24144)}),_N_E=e.O()}]);