(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8592],{47118:function(e,a,s){Promise.resolve().then(s.bind(s,77676))},77676:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return g}});var t=s(57437),n=s(2265),l=s(99376),r=s(40525),i=s(92610),c=s(86760),d=s(29501),o=s(13590),m=s(31229),x=s(56334),u=s(92827),h=s(6819),p=s(88333),j=s(70757),b=s(14121),v=s(97869),y=s(59646);let f=m.Ry({name:m.Z_().min(1,"Income source name is required"),type:m.jb(b.Rp),partner:m.Km(["partner1","partner2","joint"]),amount:m.Rx().positive("Amount must be positive"),currency:m.jb(v.NE),frequency:m.jb(b.oF),taxable:m.O7(),taxTreatment:m.Km(["standard","nhr","exempt"]).optional(),description:m.Z_().optional()});var N=e=>{var a,s,l,r,i,m;let{scenarioId:N,onSave:g}=e,{income:{tempIncomes:T,taxRegime:C,totalGrossIncome:S,totalNetIncome:w,addIncome:I,updateIncome:_,deleteIncome:O,setTaxRegime:R,loadIncomesFromScenario:A,calculateTotals:F},fx:{settings:k},activeScenario:q,updateScenario:L}=(0,c.o)(),[E,J]=(0,n.useState)(null),[P,D]=(0,n.useState)(!1),{register:z,handleSubmit:H,reset:M,setValue:B,watch:G,formState:{errors:K}}=(0,d.cI)({resolver:(0,o.F)(f),defaultValues:{type:b.Rp.EMPLOYMENT,partner:"partner1",currency:k.baseCurrency,frequency:b.oF.MONTHLY,taxable:!0,taxTreatment:"standard"}});(0,n.useEffect)(()=>{if(N&&q){var e;A(q.content.incomeSources||[],null===(e=q.content.household)||void 0===e?void 0:e.taxRegime)}},[N,q,A]);let U=G("taxable"),Y=async()=>{N&&q&&(await L(N,{content:{...q.content,incomeSources:T,household:{...q.content.household,taxRegime:C}}}),null==g||g())},Z=e=>{J(e.id),B("name",e.name),B("type",e.type),B("partner",e.partner),B("amount",e.amount.amount),B("currency",e.amount.currency),B("frequency",e.frequency),B("taxable",e.taxable),B("taxTreatment",e.taxTreatment||"standard"),B("description",e.description||""),D(!0)},V=e=>{confirm("Are you sure you want to delete this income source?")&&(O(e),N&&Y())},W=Object.values(b.Rp).map(e=>({value:e,label:e.charAt(0)+e.slice(1).toLowerCase().replace("_"," ")})),Q=Object.values(b.oF).map(e=>({value:e,label:e.charAt(0)+e.slice(1).toLowerCase()})),X=Object.values(v.NE).map(e=>({value:e,label:e})),$=[{value:v.LT.STANDARD,label:"Standard Tax Regime"},{value:v.LT.PORTUGAL_NHR,label:"Portugal NHR (20% flat rate)"}];return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(j.default,{children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Tax Regime"}),(0,t.jsx)(h.default,{value:C,onChange:e=>{R(e.target.value),F()},options:$})]})}),(0,t.jsx)(j.default,{children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Income Summary"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Total Gross Income"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[S.currency," ",S.amount.toFixed(2),"/month"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Total Net Income"}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:[w.currency," ",w.amount.toFixed(2),"/month"]})]})]})]})}),(0,t.jsx)(j.default,{children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Income Sources"}),!P&&(0,t.jsxs)(x.default,{onClick:()=>D(!0),variant:"primary",size:"sm",children:[(0,t.jsx)(y.JO,{icon:"mdi:plus",className:"mr-2"}),"Add Income Source"]})]}),T.length>0&&(0,t.jsx)("div",{className:"space-y-3 mb-6",children:T.map(e=>(0,t.jsx)("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h4",{className:"font-medium",children:e.name}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["joint"===e.partner?"Joint":"Partner ".concat(e.partner.slice(-1))," •",e.type.toLowerCase()," •",e.frequency.toLowerCase()]}),(0,t.jsxs)("p",{className:"text-sm font-medium mt-1",children:[e.amount.currency," ",e.amount.amount.toFixed(2),e.taxable&&e.taxTreatment&&(0,t.jsxs)("span",{className:"text-gray-500",children:[" (",e.taxTreatment,")"]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(x.default,{onClick:()=>Z(e),variant:"outline",size:"sm",children:(0,t.jsx)(y.JO,{icon:"mdi:pencil"})}),(0,t.jsx)(x.default,{onClick:()=>V(e.id),variant:"outline",size:"sm",children:(0,t.jsx)(y.JO,{icon:"mdi:delete"})})]})]})},e.id))}),P&&(0,t.jsxs)("form",{onSubmit:H(e=>{let a={name:e.name,description:e.description,type:e.type,partner:e.partner,amount:{amount:e.amount,currency:e.currency},frequency:e.frequency,isActive:!0,taxable:e.taxable,taxTreatment:e.taxTreatment};E?(_(E,a),J(null)):I(a),M(),D(!1),N&&Y()}),className:"space-y-4 border-t pt-4",children:[(0,t.jsx)("h4",{className:"font-medium",children:E?"Edit Income Source":"Add Income Source"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(p._,{htmlFor:"name",children:"Income Source Name"}),(0,t.jsx)(u.default,{id:"name",...z("name"),placeholder:"e.g., Main Salary, Rental Income",error:null===(a=K.name)||void 0===a?void 0:a.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(p._,{htmlFor:"type",children:"Income Type"}),(0,t.jsx)(h.default,{id:"type",...z("type"),options:W,error:null===(s=K.type)||void 0===s?void 0:s.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(p._,{htmlFor:"partner",children:"Partner"}),(0,t.jsx)(h.default,{id:"partner",...z("partner"),options:[{value:"partner1",label:"Partner 1"},{value:"partner2",label:"Partner 2"},{value:"joint",label:"Joint Income"}],error:null===(l=K.partner)||void 0===l?void 0:l.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(p._,{htmlFor:"amount",children:"Amount"}),(0,t.jsx)(u.default,{id:"amount",type:"number",step:"0.01",...z("amount",{valueAsNumber:!0}),placeholder:"0.00",error:null===(r=K.amount)||void 0===r?void 0:r.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(p._,{htmlFor:"currency",children:"Currency"}),(0,t.jsx)(h.default,{id:"currency",...z("currency"),options:X,error:null===(i=K.currency)||void 0===i?void 0:i.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(p._,{htmlFor:"frequency",children:"Frequency"}),(0,t.jsx)(h.default,{id:"frequency",...z("frequency"),options:Q,error:null===(m=K.frequency)||void 0===m?void 0:m.message})]}),(0,t.jsx)("div",{children:(0,t.jsxs)(p._,{htmlFor:"taxable",children:[(0,t.jsx)("input",{id:"taxable",type:"checkbox",...z("taxable"),className:"mr-2"}),"Taxable Income"]})}),U&&(0,t.jsxs)("div",{children:[(0,t.jsx)(p._,{htmlFor:"taxTreatment",children:"Tax Treatment"}),(0,t.jsx)(h.default,{id:"taxTreatment",...z("taxTreatment"),options:[{value:"standard",label:"Standard"},{value:"nhr",label:"NHR Rate"},{value:"exempt",label:"Tax Exempt"}]})]}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)(p._,{htmlFor:"description",children:"Description (Optional)"}),(0,t.jsx)(u.default,{id:"description",...z("description"),placeholder:"Additional notes about this income"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(x.default,{type:"submit",variant:"primary",children:[E?"Update":"Add"," Income"]}),(0,t.jsx)(x.default,{type:"button",variant:"outline",onClick:()=>{M(),D(!1),J(null)},children:"Cancel"})]})]})]})}),N&&(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(x.default,{onClick:Y,variant:"primary",size:"lg",children:"Save Income Data to Scenario"})})]})},g=e=>{let{params:a}=e,s=(0,l.useRouter)(),{activeScenario:c,setActiveScenarioId:d,loadScenarios:o}=(0,r.Th)(),[m,u]=(0,n.useState)("overview");if((0,n.useEffect)(()=>{c||o(),d(a.scenarioId)},[a.scenarioId,d,o,c]),!c)return(0,t.jsx)(i._z,{children:(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("p",{className:"text-gray-500",children:"Loading scenario..."})})});let h=[{id:"overview",label:"Overview",icon:"mdi:view-dashboard"},{id:"income",label:"Income",icon:"mdi:cash-multiple"},{id:"housing",label:"Housing",icon:"mdi:home",disabled:!0},{id:"transportation",label:"Transportation",icon:"mdi:car",disabled:!0},{id:"education",label:"Education",icon:"mdi:school",disabled:!0},{id:"healthcare",label:"Healthcare",icon:"mdi:hospital",disabled:!0},{id:"lifestyle",label:"Lifestyle",icon:"mdi:shopping",disabled:!0},{id:"analysis",label:"Analysis",icon:"mdi:chart-line",disabled:!0}],p=e=>{u(e)};return(0,t.jsxs)(i._z,{children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)(x.default,{onClick:()=>{s.push("/scenarios")},variant:"outline",size:"sm",className:"mb-4",children:[(0,t.jsx)(y.JO,{icon:"mdi:arrow-left",className:"mr-2"}),"Back to Scenarios"]}),(0,t.jsx)("h1",{className:"text-3xl font-bold",children:c.name}),(0,t.jsxs)("p",{className:"text-gray-600 mt-2",children:["Build your complete financial picture for moving from ",c.content.originCountry," to ",c.content.destinationCountry]})]}),(0,t.jsx)("div",{className:"tabs tabs-boxed mb-6",children:h.map(e=>(0,t.jsxs)("button",{onClick:()=>!e.disabled&&p(e.id),className:"tab ".concat(m===e.id?"tab-active":""," ").concat(e.disabled?"tab-disabled opacity-50 cursor-not-allowed":""),disabled:e.disabled,children:[(0,t.jsx)(y.JO,{icon:e.icon,className:"mr-2"}),e.label]},e.id))}),(0,t.jsx)("div",{className:"mt-6",children:(()=>{switch(m){case"overview":return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-base-100 p-6 rounded-lg shadow-sm",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Scenario Details"}),(0,t.jsxs)("dl",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm text-gray-500",children:"Name"}),(0,t.jsx)("dd",{className:"font-medium",children:c.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm text-gray-500",children:"Created"}),(0,t.jsx)("dd",{className:"font-medium",children:new Date(c.createdAt).toLocaleDateString()})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm text-gray-500",children:"Origin Country"}),(0,t.jsx)("dd",{className:"font-medium",children:c.content.originCountry})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm text-gray-500",children:"Destination Country"}),(0,t.jsx)("dd",{className:"font-medium",children:c.content.destinationCountry})]})]})]}),(0,t.jsxs)("div",{className:"bg-base-100 p-6 rounded-lg shadow-sm",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Completion Status"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Complete each section to build your comprehensive relocation budget."}),(0,t.jsx)("div",{className:"space-y-2",children:h.slice(1,-1).map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(y.JO,{icon:e.icon,className:"text-xl ".concat(e.disabled?"text-gray-400":"text-primary")}),(0,t.jsx)("span",{className:e.disabled?"text-gray-500":"",children:e.label})]}),(0,t.jsx)("span",{className:"text-sm ".concat(e.disabled?"text-gray-400":"text-green-600"),children:e.disabled?"Not Started":"In Progress"})]},e.id))})]})]});case"income":return(0,t.jsx)(N,{scenarioId:a.scenarioId,onSave:()=>{console.log("Income data saved")}});default:return(0,t.jsxs)("div",{className:"bg-base-100 p-8 rounded-lg text-center",children:[(0,t.jsx)(y.JO,{icon:"mdi:construction",className:"text-6xl text-gray-400 mb-4 mx-auto"}),(0,t.jsx)("p",{className:"text-gray-500",children:"This section is coming soon!"})]})}})()})]})}},88333:function(e,a,s){"use strict";s.d(a,{_:function(){return o}});var t=s(57437),n=s(2265),l=s(85293),r=s(90535),i=s(61994),c=s(53335);let d=(0,r.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=n.forwardRef((e,a)=>{let{className:s,asChild:n=!1,...r}=e,o=n?l.g7:"label";return(0,t.jsx)(o,{className:function(){for(var e=arguments.length,a=Array(e),s=0;s<e;s++)a[s]=arguments[s];return(0,c.m6)((0,i.W)(a))}(d(),s),ref:a,...r})});o.displayName="Label"}},function(e){e.O(0,[7648,6373,4264,5050,9646,6760,1218,478,2971,2117,1744],function(){return e(e.s=47118)}),_N_E=e.O()}]);